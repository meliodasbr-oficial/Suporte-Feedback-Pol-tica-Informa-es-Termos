<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style3.css">
    <title>Enviar Feedback</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDZGH-M9RjVQ_0iXX15hHqAX36Cpjvu3hQ",
            authDomain: "feedbacks-d5981.firebaseapp.com",
            projectId: "feedbacks-d5981",
            storageBucket: "feedbacks-d5981.appspot.com",
            messagingSenderId: "450937754382",
            appId: "1:450937754382:web:45906d32467ddd462f7d5f",
            measurementId: "G-CQSJ0T3FXD"
        };

        // Inicializa o Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Função para enviar feedback
        async function enviarFeedback() {
            const nome = document.getElementById('nome').value;
            const email = document.getElementById('email').value;
            const mensagem = document.getElementById('mensagem').value;
            const avaliacao = document.getElementById('avaliacao').value;
            const app = document.getElementById('app').value;
            const data = new Date();

            try {
                // Envia o feedback para o Firestore
                await addDoc(collection(db, "feedbacks"), {
                    nome: nome,
                    email: email,
                    mensagem: mensagem,
                    avaliacao: parseInt(avaliacao),
                    app: app,
                    data: data.toISOString()
                });

                // Configuração do EmailJS para enviar o feedback para o seu email
                emailjs.send("service_1s24rqp", "template_msnrwnl", {
                    nome: nome,
                    email: email,
                    mensagem: mensagem,
                    avaliacao: avaliacao,
                    app: app,
                    data: data.toISOString()
                }).then((response) => {
                    alert("Feedback enviado com sucesso e armazenado!");
                }, (error) => {
                    console.error("Erro ao enviar email:", error);
                    alert("Erro ao enviar o feedback. Por favor, tente novamente.");
                });

            } catch (e) {
                console.error("Erro ao enviar feedback: ", e);
                alert("Erro ao enviar feedback. Tente novamente.");
            }
        }
    </script>
    <!-- Adiciona o SDK do EmailJS -->
    <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("dDWLYAbLMPlBXA9Dp"); // Substitua pelo seu USER ID do EmailJS
        })();
    </script>
</head>
<body>
    <div class="container">
        <h1>Enviar Feedback</h1>
        <label for="nome">Nome:</label><br>
        <input type="text" id="nome" name="nome"><br><br>

        <label for="email">Email:</label><br>
        <input type="email" id="email" name="email"><br><br>

        <label for="mensagem">Mensagem:</label><br>
        <textarea id="mensagem" name="mensagem"></textarea><br><br>

        <label for="avaliacao">Avaliação (1 a 5):</label><br>
        <input type="number" id="avaliacao" name="avaliacao" min="1" max="5"><br><br>

        <label for="app">Aplicativo:</label><br>
        <input type="text" id="app" name="app"><br><br>

        <button onclick="enviarFeedback()">Enviar Feedback</button>
    </div>
</body>
</html>
